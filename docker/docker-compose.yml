version: "3.8"
services:
  event_bridge:
    build:
      context: ../
      dockerfile: docker/event-bridge.Dockerfile
    environment:
      - WEBHOOK_PORT=${WEBHOOK_PORT:-5000}
      - SYSLOG_UDP_PORT=${SYSLOG_UDP_PORT:-514}
    ports:
      - "${WEBHOOK_PORT:-5000}:5000"
      - "${SYSLOG_UDP_PORT:-514}:514/udp"
    volumes:
      - ../:/repo
  ai_generator:
    build:
      context: ../
      dockerfile: docker/ai-generator.Dockerfile
    environment:
      - MODEL_MODE=${MODEL_MODE:-local}
      - LLM_ENDPOINT=${LLM_ENDPOINT}
      - API_KEY=${API_KEY}
    volumes:
      - ../:/repo
  runner:
    build:
      context: ../
      dockerfile: docker/runner.Dockerfile
    ports:
      - "${REVIEW_UI_PORT:-8088}:8088"
    volumes:
      - ../:/repo
    depends_on:
      - event_bridge
      - ai_generator
